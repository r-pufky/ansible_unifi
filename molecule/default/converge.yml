---
- name: 'Converge'
  hosts: 'all'
  gather_facts: true  # /proc AVX detection.
  become: true
  tasks:
    - name: 'Converge | simulate user media restriction'
      ansible.builtin.file:
        path: '{{ item }}'
        owner: 400
        group: 400
        mode: '0755'
        state: 'directory'
      loop:
        - '/data/unifi'

    - name: 'Prepare | add testing users'
      ansible.builtin.user:
        name: '{{ item }}'
      loop:
        - 'test'
        - 'test2'

    - name: 'Converge | apply r_pufky.srv.unifi'
      ansible.builtin.include_role:
        name: 'r_pufky.srv.unifi'
